(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{10:function(e,t,a){e.exports=a(17)},15:function(e,t,a){},16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),l=a(8),i=a.n(l),r=(a(15),a(1)),o=Object(n.createContext)({theme:"dark"}),s=Object(n.createContext)({user:null}),u=a(9),m={REFRESH:"refresh",CHECK_USER:"checkUser",UPDATE_USER:"updateUser",DISPLAY_ERROR:"displayError",HIDE_ERROR:"hideError",SET_THEME:"setTheme"},E={};Object.values(m).forEach((function(e){E[e]=[]}));var d=function(e,t){var a=E[e];if(a){var n,c=Object(u.a)(a);try{for(c.s();!(n=c.n()).done;){(0,n.value)(t)}}catch(l){c.e(l)}finally{c.f()}}},f=function(e,t){var a=E[e];a&&a.indexOf(t)<0&&a.push(t)},b=function(e,t){var a=E[e];if(a){var n=a.indexOf(t);n>-1&&a.splice(n,1)}},g=400,p=401,v=403,h=503,O=0,j=1,R=2,k=3,N=4,C=5,S=function(e){return new Date(e).toISOString()},y=function(e){return new Date(e).toLocaleDateString("en-US")},P=Object(n.memo)((function(){var e=Object(n.useState)(""),t=Object(r.a)(e,2),a=t[0],l=t[1];return Object(n.useEffect)((function(){var e=-1,t=function(t){clearTimeout(e),l(function(e){var t="";switch(e){case O:t="User name is not valid!";break;case j:t="Unable to connect to server! Please try again!";break;case R:t="Wrong article id!";break;case k:t="Please login first!";break;case N:t="Param error!";break;case C:default:t="Something went wrong!"}return t}(t)),e=setTimeout((function(){a()}),1e4)},a=function(){clearTimeout(e),e=-1,l("")};return f(m.DISPLAY_ERROR,t),f(m.HIDE_ERROR,a),function(){b(m.DISPLAY_ERROR,t),b(m.HIDE_ERROR,a)}}),[]),c.a.createElement("div",{className:"error ".concat(""===a?"":"display")},a)})),I=Object(n.memo)((function(){return c.a.createElement("footer",null,c.a.createElement("ul",{className:"footer-personal-info"},c.a.createElement("li",null,"\xa9 2020 Yiji Huang"),c.a.createElement("li",{className:"footer-divider"}),c.a.createElement("li",null,c.a.createElement("span",null,"E-mail: "),c.a.createElement("a",{href:"mailto:huang.yiji@northeastern.edu"},"huang.yiji@northeastern.edu")),c.a.createElement("li",{className:"footer-divider"}),c.a.createElement("li",null,c.a.createElement("span",null,"Icons by "),c.a.createElement("a",{href:"https://icons8.com"},"Icons8"))))})),T=a(5),D={},_={GET:"get",PUT:"put",DELETE:"delete",POST:"post"};Object.values(_).forEach((function(e){var t={method:e};D[e.toLowerCase()]=function(a,n){var c=Object(T.a)({},t);if(n)if(e!==_.GET)c.headers={"Content-Type":"application/json"},c.body=JSON.stringify(n);else{var l=Object.entries(n).map((function(e){var t=Object(r.a)(e,2),a=t[0],n=t[1];return"".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(n))})).join("&");a+=""===l?"":"?"+l}return fetch(a,c).catch((function(){return Promise.reject({ok:!1,status:h})})).then((function(e){return e.ok?e.json():Promise.reject(e)}))}}));var A=D,w="displayName",U="theme",H="contactInfo",L="email",Y="github",x="linkedin",M="area",F="description",V=function(e,t){return t?"".concat("/user","/").concat(e,"/").concat(t):"".concat("/user","/").concat(e)},B=function(e){return e?"".concat("/article","/").concat(e):"/article"},K=a(6),W=Object(n.memo)((function(e){var t=e.article,a=void 0===t?{}:t,l=e.action,i=a.articleId,o=void 0===i?"":i,s=a.articleTitle,u=void 0===s?"":s,m=a.articleContent,E=void 0===m?"":m,d=a.articleTags,f=void 0===d?[]:d,b=Object(n.useState)(u),g=Object(r.a)(b,2),p=g[0],v=g[1],h=Object(n.useState)(E),O=Object(r.a)(h,2),j=O[0],R=O[1],k=Object(n.useState)(""),N=Object(r.a)(k,2),C=N[0],S=N[1],y=Object(n.useReducer)((function(e,t){var a=t.tag;switch(t.type){case"add":return-1===e.indexOf(a)?[].concat(Object(K.a)(e),[a]):e;case"remove":var n=e.indexOf(a);return n>-1?[].concat(Object(K.a)(e.slice(0,n)),Object(K.a)(e.slice(n+1))):e;default:throw new Error("Wrong action type! Type: "+t.type)}}),f),P=Object(r.a)(y,2),I=P[0],T=P[1],D=Object(n.useCallback)((function(){T({type:"add",tag:C}),S("")}),[C]);return c.a.createElement("div",{className:"article-edit"},c.a.createElement("label",null," Title: "),c.a.createElement("input",{type:"text",name:"title",onChange:function(e){v(e.target.value)},value:p}),c.a.createElement("label",null," Content: "),c.a.createElement("textarea",{name:"",cols:"30",rows:"10",className:"content",onChange:function(e){R(e.target.value)},value:j}),c.a.createElement("span",null,"Tags:"),c.a.createElement("div",{className:"tags"},I.map((function(e){return c.a.createElement("div",{key:e,className:"tag-edit"},c.a.createElement("span",null,e),c.a.createElement("button",{className:"tag-delete",onClick:function(){T({type:"remove",tag:e})}},"X"))}))),c.a.createElement("label",null,"Add tag:"),c.a.createElement("div",null,c.a.createElement("input",{className:"new-tag",type:"text",value:C,onChange:function(e){S(e.target.value)}}),c.a.createElement("button",{className:"tag-add",onClick:D,disabled:!C},"Add tag")),c.a.createElement("button",{disabled:!p,onClick:function(){l(p,j,I,o)}},u?"Update":"Submit"))})),J=Object(n.memo)((function(e){var t=e.article,a=e.updateThumbup,l=Object(n.useCallback)((function(){var e;A.post((e=t.id,"".concat("/article","/").concat(e).concat("/thumbsup"))).then((function(e){var t=e.count;a(t)})).catch((function(e){e.status===p||e.status===v?(d(m.DISPLAY_ERROR,k),d(m.CHECK_USER)):e.status===h&&d(m.DISPLAY_ERROR,j)}))}),[t.id,a]);return c.a.createElement("article",{className:"article-detail"},c.a.createElement("h2",{className:"title"},t.title),c.a.createElement("div",{className:"meta"},c.a.createElement("span",null,"Created: "),c.a.createElement("time",{dateTime:S(t.createTime)},y(t.createTime)),c.a.createElement("span",{className:"sperator"},"/"),c.a.createElement("span",null,"Modified: "),c.a.createElement("time",{dateTime:S(t.lastModifyTime)},y(t.lastModifyTime))),c.a.createElement("div",{className:"tags"},c.a.createElement("img",{src:"https://img.icons8.com/cotton/64/000000/price-tag--v4.png",alt:"tag-icon"}),t.tags.map((function(e){return c.a.createElement("div",{key:e,className:"tag"},c.a.createElement("span",null,e))}))),c.a.createElement("pre",{className:"content"},t.content),c.a.createElement("div",{className:"thumbup"},c.a.createElement("img",{onClick:l,src:"https://img.icons8.com/cotton/64/000000/thumb-up--v1.png",alt:"thumbup"}),c.a.createElement("span",null,t.thumbups)))})),G=Object(n.memo)((function(e){var t=e.displayDetail,a=Object(n.useState)(null),l=Object(r.a)(a,2),i=l[0],o=l[1];Object(n.useEffect)((function(){A.get(B()).then((function(e){var t=e.articles;o(t)})).catch((function(e){e.status===h&&d(m.DISPLAY_ERROR,j)}))}),[]);var s=Object(n.useMemo)((function(){if(i){var e=Object.values(i);if(0===e.length)return c.a.createElement("div",null,"No articles yet. Logged-in user can post new blog.");e.sort((function(e,t){return e.createTime-t.createTime}));var a="",n=[];return e.forEach((function(e){var l=y(e.createTime);l!==a&&(n.push(c.a.createElement("h2",{key:l},""!==a&&c.a.createElement("div",{className:"seperator"}),c.a.createElement("time",{dateTime:S(e.createTime)},l))),a=l),n.push(c.a.createElement("div",{key:e.id,className:"article"},c.a.createElement("h3",{className:"title",onClick:function(){t(e)}},e.title),c.a.createElement("p",{className:"content"},e.content),c.a.createElement("div",{className:"tags"},c.a.createElement("img",{src:"https://img.icons8.com/cotton/64/000000/price-tag--v4.png",alt:"tag-icon",className:"tag-icon"}),e.tags.map((function(e){return c.a.createElement("span",{key:e,className:"tag"},e)})))))})),n}return c.a.createElement("div",null,"loading...")}),[i,t]);return c.a.createElement("div",{className:"article-brief"},s)})),X=Object(n.memo)((function(){var e=Object(n.useContext)(s),t=Object(n.useState)("displayPage"),a=Object(r.a)(t,2),l=a[0],i=a[1],o=Object(n.useState)(null),u=Object(r.a)(o,2),E=u[0],O=u[1];Object(n.useEffect)((function(){var e=function(){i("displayPage")};return f(m.REFRESH,e),function(){b(m.REFRESH,e)}}),[]);var R=Object(n.useCallback)((function(e,t,a,n){var c={title:e,content:t,tags:a};(n?A.put(B(n),c):A.post(B(),c)).then((function(e){var t=e.article;O(t),i("detailPage")})).catch((function(e){e.status===p||e.status===v?(d(m.DISPLAY_ERROR,k),d(m.CHECK_USER),i(n?"detailPage":"displayPage")):e.status===g?d(m.DISPLAY_ERROR,N):e.status===h&&d(m.DISPLAY_ERROR,j)}))}),[]),C=Object(n.useCallback)((function(e){O(e),i("detailPage")}),[]),S=Object(n.useCallback)((function(e){O(Object(T.a)({},E,{thumbups:e}))}),[E]),y=Object(n.useMemo)((function(){return c.a.createElement("div",{className:"home"},c.a.createElement("button",{onClick:function(){i("displayPage")},className:"article-action"},"Home"),c.a.createElement(W,{action:R}))}),[R]),P=Object(n.useMemo)((function(){if(E)return c.a.createElement("div",{className:"home"},c.a.createElement("button",{onClick:function(){i("displayPage")},className:"article-action"},"Home"),c.a.createElement("button",{onClick:function(){i("detailPage")},className:"article-action"},"Cancel"),c.a.createElement(W,{action:R,article:{articleId:E.id,articleTitle:E.title,articleContent:E.content,articleTags:E.tags}}))}),[R,E]),I=Object(n.useMemo)((function(){return c.a.createElement("div",{className:"home"},e&&c.a.createElement("button",{onClick:function(){i("addPage")},className:"article-action"},"New Article"),c.a.createElement(G,{displayDetail:C}))}),[e,C]),D=Object(n.useMemo)((function(){return c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){i("displayPage")},className:"article-action"},"Home"),e&&c.a.createElement("button",{onClick:function(){i("editPage")},className:"article-action"},"Edit"),E?c.a.createElement(J,{article:E,updateThumbup:S}):c.a.createElement("div",null,"loading"))}),[e,E,S]);return Object(n.useMemo)((function(){var e;switch(l){case"addPage":e=y;break;case"detailPage":e=D;break;case"editPage":e=P;break;case"displayPage":default:e=I}return e}),[l,y,D,I,P])})),$=Object(n.memo)((function(){var e=Object(n.useState)(""),t=Object(r.a)(e,2),a=t[0],l=t[1],i=Object(n.useCallback)((function(e){var t=e.target.value;l(t)}),[l]),o=Object(n.useCallback)((function(e){e.preventDefault(),A.post("/session",{username:a}).then((function(){l(""),d(m.HIDE_ERROR),d(m.REFRESH)})).catch((function(e){e.status===p||e.status===v?(l(""),d(m.DISPLAY_ERROR,k)):e.status===g?(l(""),d(m.DISPLAY_ERROR,O)):e.status===h&&d(m.DISPLAY_ERROR,j)}))}),[a,l]);return c.a.createElement("div",{className:"login-page"},c.a.createElement("label",null,"User Name:",c.a.createElement("input",{id:"user-name",type:"text",value:a,onChange:i,minLength:1})),c.a.createElement("button",{className:"signin",onClick:o},"Sign in"))})),q=a(4),z=Object(n.memo)((function(e){var t=e.update,a=e.originValue,l=void 0===a?"":a,i=e.readonly,o=void 0!==i&&i,s=Object(n.useState)(l),u=Object(r.a)(s,2),m=u[0],E=u[1],d=Object(n.useState)(!1),f=Object(r.a)(d,2),b=f[0],g=f[1],p=Object(n.useRef)(null),v=Object(n.useCallback)((function(e){t&&t(e),g(!1)}),[t]),h=Object(n.useCallback)((function(){o||g(!0)}),[o]),O=Object(n.useCallback)((function(){E(l),g(!1)}),[l]);return Object(n.useEffect)((function(){b&&p&&p.current&&p.current.focus()}),[p,b]),c.a.createElement("div",{className:"editable-input"},b?c.a.createElement("div",{className:"edit"},c.a.createElement("input",{value:m,onChange:function(e){E(e.target.value)},ref:p}),c.a.createElement("button",{onClick:function(){return v(m)}},"Confirm"),c.a.createElement("button",{onClick:O},"Cancel")):c.a.createElement("div",{className:"read",onClick:h},c.a.createElement("span",null,m||"empty"),c.a.createElement("img",{src:"https://img.icons8.com/cotton/50/000000/edit.png",alt:"edit",className:"edit-icon"})))})),Q=Object(n.memo)((function(){var e=Object(n.useContext)(s),t=Object(n.useContext)(o),a=Object(n.useCallback)((function(t){return function(a){A.put(V(e.id,t),Object(q.a)({},t,a)).then((function(e){var t=e.user;d(m.UPDATE_USER,t)})).catch((function(e){e.status===p||e.status===v?(d(m.DISPLAY_ERROR,k),d(m.REFRESH)):e.status===g?d(m.DISPLAY_ERROR,N):e.status===h&&d(m.DISPLAY_ERROR,j)}))}}),[e]),l=Object(n.useCallback)((function(e){return function(t){a(H)(Object(q.a)({},e,t))}}),[a]);return c.a.createElement("div",{className:"profile"},c.a.createElement("section",{className:"basic"},c.a.createElement("h3",{className:"title"},"Basic Information"),c.a.createElement("img",{src:"https://img.icons8.com/dusk/64/000000/employee-card.png",alt:"name",className:"label",title:"name"}),c.a.createElement(z,{originValue:e.displayName,update:a(w)}),c.a.createElement("img",{src:"https://img.icons8.com/dusk/64/000000/change-theme.png",alt:"theme",className:"label",title:"theme"}),c.a.createElement("div",{className:"theme"},c.a.createElement("label",null,"Dark :",c.a.createElement("input",{type:"radio",name:"theme",checked:"dark"===t,onChange:function(){return a(U)("dark")}})),c.a.createElement("label",null,"Light :",c.a.createElement("input",{type:"radio",name:"theme",checked:"light"===t,onChange:function(){return a(U)("light")}})))),c.a.createElement("section",{className:"contact"},c.a.createElement("h3",{className:"title"},"Contact Information"),c.a.createElement("img",{src:"https://img.icons8.com/bubbles/50/000000/map-marker.png",alt:"area",className:"label",title:"area"}),c.a.createElement(z,{originValue:e.profile.contactInfo.area,update:l(M)}),c.a.createElement("img",{src:"https://img.icons8.com/bubbles/50/000000/email.png",alt:"email",className:"label",title:"email"}),c.a.createElement(z,{originValue:e.profile.contactInfo.email,update:l(L)}),c.a.createElement("img",{src:"https://img.icons8.com/doodle/48/000000/github--v1.png",alt:"github",className:"label",title:"github"}),c.a.createElement(z,{originValue:e.profile.contactInfo.github,update:l(Y)}),c.a.createElement("img",{src:"https://img.icons8.com/doodle/48/000000/linkedin--v2.png",alt:"linkedin",className:"label",title:"linkedin"}),c.a.createElement(z,{originValue:e.profile.contactInfo.linkedin,update:l(x)}),c.a.createElement("img",{src:"https://img.icons8.com/dusk/64/000000/note.png",alt:"description",className:"label",title:"description"}),c.a.createElement(z,{originValue:e.profile.contactInfo.description,update:l(F)})))}));a(16);var Z=function(){var e=Object(n.useState)(null),t=Object(r.a)(e,2),a=t[0],l=t[1],i=Object(n.useState)("home"),u=Object(r.a)(i,2),E=u[0],g=u[1],p=Object(n.useState)("dark"),v=Object(r.a)(p,2),O=v[0],R=v[1],k=Object(n.useCallback)((function(){A.get("/session").then((function(e){var t=e.userid;return A.get(V(t))})).then((function(e){var t=e.user;d(m.HIDE_ERROR),l(t),R(t.theme||"dark")})).catch((function(e){e.status===h?d(m.DISPLAY_ERROR,j):(l(null),R("dark"))}))}),[]),N=Object(n.useCallback)((function(){g("home"),k()}),[k]),C=Object(n.useCallback)((function(){A.delete("/session").finally((function(){g("home"),l(null),R("dark")}))}),[]);Object(n.useEffect)((function(){N();var e=function(e){l(e),R(e.theme||"dark")};return f(m.REFRESH,N),f(m.CHECK_USER,k),f(m.UPDATE_USER,e),function(){b(m.REFRESH,N),b(m.CHECK_USER,k),b(m.UPDATE_USER,e)}}),[N,k]);var S=Object(n.useMemo)((function(){return a?c.a.createElement("ol",null,c.a.createElement("li",{className:"nav",onClick:function(){g("home")}},"Blog"),c.a.createElement("li",{className:"nav",onClick:function(){g("profile")}},"Profile"),c.a.createElement("li",{className:"nav",onClick:function(){C()}},"Sign Out")):c.a.createElement("ol",null,c.a.createElement("li",{className:"nav",onClick:function(){g("home")}},"Blog"),c.a.createElement("li",{className:"nav",onClick:function(){g("login")}},"Sign In"))}),[a,C]),y=Object(n.useMemo)((function(){var e;switch(E){case"login":e=c.a.createElement($,null);break;case"profile":e=c.a.createElement(Q,null);break;case"home":default:e=c.a.createElement(X,null)}return e}),[E]);return c.a.createElement("div",{className:"".concat(O+"-theme"," App")},c.a.createElement(s.Provider,{value:a},c.a.createElement("header",null,c.a.createElement("nav",{className:"navigations"},c.a.createElement("img",{src:"/logo.png",alt:"blog logo",className:"logo-title"}),c.a.createElement("h1",null,"Welcome",a?", "+a.displayName:" to my Blog"),S)),c.a.createElement("main",null,c.a.createElement(P,null),c.a.createElement(o.Provider,{value:O},y))),c.a.createElement(I,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.9f8f4cc7.chunk.js.map