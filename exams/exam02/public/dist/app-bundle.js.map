{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js","webpack:///./node_modules/@babel/runtime/regenerator/index.js","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./ts/main.ts","webpack:///./ts/model/chat.ts","webpack:///./ts/model/dataInterface.ts","webpack:///./ts/model/login.ts","webpack:///./ts/model/long-connection.ts","webpack:///./ts/model/sse.ts","webpack:///./ts/model/users.ts","webpack:///./ts/model/websocket.ts","webpack:///./ts/utils/mini-jquery.ts","webpack:///./ts/utils/status-error-codes.ts","webpack:///./ts/viewcontroller/chat.ts","webpack:///./ts/viewcontroller/error.ts","webpack:///./ts/viewcontroller/index.ts","webpack:///./ts/viewcontroller/login.ts"],"names":["init","URL","timestamp","getURL","isLong","sendMessage","message","$","post","getMessage","get","getLongMessage","then","res","ok","json","Promise","reject","intervalHandler","shortMessageResolver","shortMessageRejecter","beginShowMessageLoop","setInterval","datas","length","filter","data","getShortMessage","resolve","signalRejecter","signalPromise","getSignal","receiveMessage","tmpTimestamp","Math","max","race","getChat","stopMessage","longStop","clearInterval","TYPE","signIn","userName","signOut","userTimeStamp","chatTimeStamp","userResolver","chatResolver","isStarted","filterMessage","type","CHAT","newData","users","start","sseStart","wsStart","stop","sseStop","wsStop","getUsers","evtSource","cb","EventSource","onmessage","event","JSON","parse","e","close","getUser","getLongUser","shortUserResolver","shortUserRejecter","beginShowUserLoop","setTimeout","getShortUser","receiveUsers","stopUser","ws","ONE_MINUTE","WebSocket","ping","send","stringify","onopen","window","onbeforeunload","onclose","DEFAULT_KEY","CLASS_NAME_ERROR","ATTR_DATE_TIME","MiniJquery","parameters","targetElement","document","querySelector","createElement","element","callback","addEventListener","child","appendChild","htmlElement","parentNode","removeChild","innerHTML","query","key","dataset","newToken","oldToken","classList","add","replace","content","textContent","setAttribute","scrollTop","scrollHeight","value","outerHTML","className","toggle","remove","time","Date","toLocaleString","innerText","disabledAttr","disabled","hidden","clone","cloneNode","METHOD","GET","POST","DELETE","PUT","forEach","method","param","toLowerCase","url","headers","body","fetch","STATUS_CODES","ERROR_CODES","chatPageTemplate","userTemplate","chatTemplate","resolver","displayChat","parent","updateChat","messagePage","templateClone","name","find","updateContent","append","handlePromise","scrollToButtom","removeChildren","displayUser","updateUser","userParent","userPage","console","error","displayChatPage","stage","chat","chatPage","signout","disable","onClick","preventDefault","onInput","response","hideError","status","UNAUTHORIZED","CLASS_DISPLAY","errorview","displayError","text","addClass","removeClass","PAGES","WRONT_USER_ID_MESSAGE","loading","currentPage","displayPage","page","LOGIN","displayLoginPage","renderPage","errorMessage","errorCode","WRONG_USER_ID","USER_NAME_ERROR_MESSAGE","UNEXPECTED_ERROR_MESSAGE","template","parentElement","loginPage","input","signin","rejecter","Error","clearValue","WRONG_USER_NAME"],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA,mC;;;;;;;;;;;ACpCA;AACA;AACA;AACA;AACA;;AAEA,iC;;;;;;;;;;;ACNA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,8B;;;;;;;;;;;AChBA,iBAAiB,mBAAO,CAAC,0EAAqB;;;;;;;;;;;;ACA9C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,KAAK;AACL,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;;AAEA;AACA;AACA,wCAAwC,WAAW;AACnD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oCAAoC,cAAc;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,iCAAiC,kBAAkB;AACnD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,8CAA8C,QAAQ;AACtD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,KAAK;;AAEL;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE,KAA0B,oBAAoB,SAAE;AAClD;;AAEA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACxtBA;AAAA;AAAA;AACAA,qEAAI,G;;;;;;;;;;;;ACDJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA,IAAMC,GAAG,GAAG,OAAZ;AACA,IAAIC,SAAgB,GAAG,CAAvB;;AACA,IAAMC,MAAM,GAAG,SAATA,MAAS,GAAsC;AAAA,MAArCC,MAAqC,uEAAjB,KAAiB;AACjD,SAAO,CAACA,MAAM,GAAG,OAAH,GAAa,EAApB,IAA0BH,GAAjC;AACH,CAFD;;AAIA,IAAMI,WAAW,GAAG,SAAdA,WAAc,CAACC,OAAD,EAAuC;AACvD,SAAOC,0DAAC,CAACC,IAAF,CAAOL,MAAM,EAAb,EAAiB;AAACG,W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","file":"app-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./ts/main.ts\");\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","module.exports = require(\"regenerator-runtime\");\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","import init from \"./viewcontroller/index\";\ninit();","import $ from \"../utils/mini-jquery\";\nimport {getChat, stop as longStop} from \"./long-connection\";\nimport { messageBody, messageObject} from \"./dataInterface\";\nconst URL = \"/chat\";\nlet timestamp:number = 0;\nconst getURL = (isLong:boolean|null=false):string => {\n    return (isLong ? \"/long\" : \"\") + URL;\n};\n\nconst sendMessage = (message: string):Promise<Response> => {\n    return $.post(getURL(), {message});\n};\n\nconst getMessage = () => {\n    return $.get(getURL());\n};\nconst getLongMessage = () => {\n    return $.get(getURL(true)).then((res:Response)=>{\n        if (res.ok) {\n            return res.json();\n        } else {\n            return Promise.reject(res);\n        }\n    });\n};\nlet intervalHandler:number = -1;\nlet shortMessageResolver:any;\nlet shortMessageRejecter:any;\nconst beginShowMessageLoop = () => {\n    if (intervalHandler === -1) {\n        intervalHandler = setInterval(() => {\n            getMessage().then((res:Response)=>{\n                if (res.ok) {\n                    res.json().then((datas:Array<messageBody>) => {\n                        if (datas.length > 0 && datas[datas.length - 1].timestamp > timestamp) {\n                            const message = datas.filter((data:messageBody) => {\n                                return data.timestamp > timestamp;\n                            });\n                            timestamp = datas[datas.length - 1].timestamp;\n                            shortMessageResolver({\n                                timestamp: timestamp,\n                                message\n                            });\n                        }\n                    });\n                } else {\n                    shortMessageRejecter(res);\n                }\n            });\n        }, 5000);\n    }\n};\nconst getShortMessage = ()=> {\n    return new Promise((resolve, reject) => {\n        shortMessageResolver = resolve;\n        shortMessageRejecter = reject;\n    });\n};\nlet signalRejecter:any;\nlet signalPromise:Promise<boolean> | null;\nconst getSignal = () => {\n    if (!signalPromise) {\n        signalPromise = new Promise((resolve, reject) => {\n            signalRejecter = reject;\n        });\n    }\n    return signalPromise;\n};\nconst receiveMessage = (tmpTimestamp:number):Promise<messageObject> => {\n    timestamp = Math.max(timestamp, tmpTimestamp);\n    beginShowMessageLoop();\n    return Promise.race([getSignal(), getChat(timestamp), getLongMessage(), getShortMessage()]).then((data:messageObject)=>{\n        if (timestamp > data.timestamp) {\n            return receiveMessage(timestamp);\n        } else {\n            timestamp = data.timestamp;\n            return data;\n        }\n    });\n};\n\nconst stopMessage = () => {\n    timestamp = 0;\n    longStop();\n    if (signalRejecter) {\n        signalRejecter();\n        signalPromise = null;\n        signalRejecter = null;\n    }\n    if (intervalHandler != -1) {\n        clearInterval(intervalHandler);\n        intervalHandler = -1;\n    }\n};\nexport {sendMessage, getMessage, receiveMessage, stopMessage};","enum TYPE {\n    USERS = \"users\",\n    CHAT = \"chat\"\n};\ninterface dataObject {\n    timestamp: number,\n    users?: Array<string>,\n    message?: Array<string>,\n    type: TYPE\n};\ninterface userObject {\n    timestamp: number,\n    users: Array<string>\n}\ninterface messageBody {\n    userName: string,\n    message: string,\n    timestamp: number\n};\ninterface messageObject {\n    timestamp: number,\n    message: Array<messageBody>\n};\nexport {TYPE, dataObject, messageBody, messageObject, userObject}","import $ from \"../utils/mini-jquery\";\nconst URL = \"/session\";\n\nconst signIn = (userName: string):Promise<Response> => {\n    return $.post(URL, {userName});\n};\n\nconst signOut = ():Promise<Response> => {\n    return $.delete(URL);\n};\n\nexport {signIn, signOut};","import {start as sseStart, stop as sseStop} from \"./sse\";\nimport {start as wsStart, stop as wsStop} from \"./websocket\";\nimport {TYPE, dataObject} from \"./dataInterface\";\n\nlet userTimeStamp:number = 0;\nlet chatTimeStamp:number = 0;\nlet userResolver:any;\nlet chatResolver:any;\nlet isStarted:boolean = false;\nconst filterMessage = (data:dataObject) => {\n    if (data.type === TYPE.CHAT) {\n        if (data.timestamp > chatTimeStamp) {\n            if (chatResolver) {\n                const newData = {\n                    timestamp: data.timestamp,\n                    message: data.message\n                };\n                chatResolver(newData);\n                chatTimeStamp = data.timestamp;\n            }\n            chatResolver = null;\n        }\n    } else {\n        if (data.timestamp > userTimeStamp) {\n            if (userResolver) {\n                const newData = {\n                    timestamp: data.timestamp,\n                    users: data.users\n                };\n                userResolver(newData);\n                userTimeStamp = data.timestamp;\n            }\n            userResolver = null;\n        }\n    }\n};\n\nconst start = () => {\n    sseStart(filterMessage);\n    wsStart(filterMessage);\n};\nconst stop = () => {\n    if (isStarted) {\n        sseStop();\n        wsStop();\n    }\n    isStarted = false;\n};\nconst getUsers = (timestamp:number):Promise<Array<string>> => {\n    if (!isStarted) {\n        start();\n        isStarted = true;\n    }\n    if (userTimeStamp < timestamp) {\n        userTimeStamp = timestamp;\n    }\n    return new Promise((resolve, reject) => {\n        userResolver = resolve;\n    });\n};\nconst getChat = (timestamp:number):Promise<Array<string>> => {\n    if (!isStarted) {\n        start();\n        isStarted = true;\n    }\n    if (chatTimeStamp < timestamp) {\n        chatTimeStamp = timestamp;\n    }\n    return new Promise((resolve, reject) => {\n        chatResolver = resolve;\n    });\n};\n\nexport {stop, getUsers, getChat}","import {dataObject} from \"./dataInterface\";\n\nlet evtSource:EventSource | null;\nconst start = (cb:(data:dataObject)=>void)=> {\n    if (!evtSource) {\n        evtSource= new EventSource(\"/sse\");\n        evtSource.onmessage = function(event:MessageEvent) {\n            try {\n                const data:dataObject = JSON.parse(event.data);\n                cb(data);\n            } catch(e) {\n        \n            }\n        }\n    }\n}\nconst stop = () => {\n    if (evtSource) {\n        evtSource.close();\n        evtSource = null;\n    }\n};\n\nexport {start, stop};","import $ from \"../utils/mini-jquery\";\nimport {getUsers, stop as longStop} from \"./long-connection\";\nimport { userObject } from \"./dataInterface\";\nconst URL = \"/users\";\nlet timestamp:number = 0;\nconst getURL = (isLong:boolean|null=false):string => {\n    return (isLong ? \"/long\" : \"\") + URL;\n};\n\nconst getUser = () => {\n    return $.get(getURL());\n};\nconst getLongUser = () => {\n    return $.get(getURL(true)).then((res:Response)=>{\n        if (res.ok) {\n            return res.json();\n        } else {\n            return Promise.reject(res);\n        }\n    });\n};\nlet intervalHandler:number = -1;\nlet shortUserResolver:any;\nlet shortUserRejecter:any;\nconst beginShowUserLoop = () => {\n    if (intervalHandler === -1) {\n        setTimeout(() => {\n            getUser().then((res:Response)=>{\n                if (res.ok) {\n                    res.json().then((data:userObject) => {\n                        if (data.timestamp > timestamp) {\n                            shortUserResolver(data);\n                        }\n                    });\n                } else {\n                    shortUserRejecter(res);\n                }\n            });\n        });\n        intervalHandler = setInterval(() => {\n            getUser().then((res:Response)=>{\n                if (res.ok) {\n                    res.json().then((data:userObject) => {\n                        if (data.timestamp > timestamp) {\n                            shortUserResolver(data.users);\n                        }\n                    });\n                } else {\n                    shortUserRejecter(res);\n                }\n            });\n        }, 5000);\n    }\n};\nconst getShortUser = ()=> {\n    return new Promise((resolve, reject) => {\n        shortUserResolver = resolve;\n        shortUserRejecter = reject;\n    });\n};\nlet signalRejecter:any;\nlet signalPromise:Promise<boolean> | null;\nconst getSignal = () => {\n    if (!signalPromise) {\n        signalPromise = new Promise((resolve, reject) => {\n            signalRejecter = reject;\n        });\n    }\n    return signalPromise;\n};\nconst receiveUsers = (tmpTimestamp:number):Promise<userObject> => {\n    timestamp = Math.max(timestamp, tmpTimestamp);\n    beginShowUserLoop();\n    return Promise.race([getSignal(), getUsers(timestamp), getLongUser(), getShortUser()]).then((data:userObject)=>{\n        if (timestamp > data.timestamp) {\n            return receiveUsers(timestamp);\n        } else {\n            timestamp = data.timestamp;\n            return data;\n        }\n    });\n};\n\nconst stopUser = () => {\n    timestamp = 0;\n    longStop();\n    if (signalRejecter) {\n        signalRejecter();\n        signalPromise = null;\n        signalRejecter = null;\n    }\n    if (intervalHandler != -1) {\n        clearInterval(intervalHandler);\n        intervalHandler = -1;\n    }\n};\nexport {receiveUsers, stopUser};","import {dataObject} from \"./dataInterface\";\n\nlet ws:WebSocket|null;\nlet intervalHandler = -1;\nconst ONE_MINUTE = 60000;\n\nconst start = (cb:(data:dataObject)=>void) => {\n    if (!ws) {\n        ws = new WebSocket('ws://localhost:3000');\n        const ping = () => {\n            clearInterval(intervalHandler);\n            intervalHandler = setInterval(()=>{\n                const ping = \"ping\";\n                ws?.send(JSON.stringify({ping}));\n            }, ONE_MINUTE)\n        };\n        ws.onmessage = (event:MessageEvent) => {\n            const data:dataObject = JSON.parse(event.data);\n            cb(data);\n            ping();\n        };\n        ws.onopen = () => {\n            ping();\n        }\n        window.onbeforeunload = () => {\n            if (ws) {\n                ws.onclose = () => {}; // disable onclose handler first\n                ws.close();\n            }\n        };\n        ws.onclose = () => {\n            clearInterval(intervalHandler);\n            intervalHandler = -1;\n            ws = null;\n        };\n    }\n};\nconst stop = () => {\n    if (ws) {\n        ws.close();\n    }\n    delete window.onbeforeunload;\n};\n\nexport {start, stop}","const DEFAULT_KEY:string = \"id\";\nconst CLASS_NAME_ERROR:string = \"error\";\nconst ATTR_DATE_TIME = \"datetime\";\nexport class MiniJquery {\n    element: HTMLElement;\n    constructor(parameters: string | HTMLElement) {\n        if (typeof parameters === \"string\") {\n            let targetElement:HTMLElement | null = null;\n            try {\n                targetElement = window.document.querySelector(parameters);\n            } catch(e) {\n\n            }\n            if (!targetElement) {\n                targetElement = window.document.createElement(\"div\");\n            }\n            this.element = targetElement;\n        } else {\n            this.element = parameters;\n        }\n    }\n    onClick(callback: (this:void, e:Event)=>void):MiniJquery {\n        this.element.addEventListener(\"click\", callback);\n        return this;\n    }\n    onInput(callback: (this:void, e:Event)=>void):MiniJquery {\n        this.element.addEventListener(\"input\", callback);\n        return this;\n    }\n    append(child: MiniJquery):MiniJquery {\n        this.element.appendChild(child.htmlElement);\n        return this;\n    }\n    removeSelf():MiniJquery {\n        if (this.element.parentNode) {\n            this.element.parentNode.removeChild(this.element);\n        }\n        return this;\n    }\n    removeChildren():MiniJquery {\n        this.element.innerHTML = \"\";\n        return this;\n    }\n    find(query: string):MiniJquery | null {\n        const targetElement:HTMLElement | null = this.element.querySelector(query) as HTMLElement;\n        if (targetElement) {\n            return new MiniJquery(targetElement);\n        } else {\n            return null;\n        }\n    }\n    getDataByKey(key:string = DEFAULT_KEY):string {\n        return this.element.dataset[key] || \"\";\n    }\n    updateClass(newToken:string, oldToken:string):MiniJquery {\n        if (oldToken === \"\") {\n            this.element.classList.add(newToken);\n        } else {\n            this.element.classList.replace(oldToken, newToken);\n        }\n        return this;\n    }\n    updateData(data:string, key:string = DEFAULT_KEY):MiniJquery {\n        this.element.dataset[key] = data; \n        return this;\n    }\n    updateContent(content: string):MiniJquery {\n        this.element.textContent = content;\n        this.element.setAttribute(\"title\", content);\n        return this;\n    }\n    scrollToButtom():MiniJquery {\n        this.element.scrollTop = this.element.scrollHeight;\n        return this;\n    }\n    clearValue():MiniJquery {\n        (this.element as HTMLInputElement).value = \"\";\n        return this;\n    }\n    toString():string {\n        return this.element.outerHTML;\n    }\n    triggleClass(className:string):MiniJquery {\n        this.element.classList.toggle(className);\n        return this;\n    }\n    addClass(className:string):MiniJquery {\n        this.element.classList.add(className);\n        return this;\n    }\n    removeClass(className:string):MiniJquery {\n        this.element.classList.remove(className);\n        return this;\n    }\n    set time(value:number) {\n        const time = new Date(value).toLocaleString();\n        this.element.setAttribute(ATTR_DATE_TIME, time);\n        this.element.innerText = time;\n    }\n    set text(value: string) {\n        this.element.innerText = value;\n    }\n    set disable(value: boolean) {\n        const disabledAttr: boolean | null = (this.element as HTMLInputElement).disabled;\n        if (disabledAttr || disabledAttr === false) {\n            (this.element as HTMLInputElement).disabled = value;\n        } \n    }\n    set hidden(value: boolean) {\n        this.element.hidden = value;\n    }\n    set error(value: boolean) {\n        if (value) {\n            this.element.classList.add(CLASS_NAME_ERROR);\n        } else {\n            this.element.classList.remove(CLASS_NAME_ERROR);\n        }\n    }\n    set value(value: string) {\n        (this.element as HTMLInputElement).value = value;\n    }\n    get disable():boolean {\n        return !!(this.element as HTMLInputElement).disabled;\n    }\n    get htmlElement():HTMLElement {\n        return this.element;\n    }\n    get parent():MiniJquery | null {\n        if (this.element.parentNode) {\n            return new MiniJquery((this.element.parentNode as HTMLElement));\n        } else {\n            return null;\n        }\n    }\n    get value():string {\n        return (this.element as HTMLInputElement).value || \"\";\n    }\n    get templateClone():MiniJquery | null{\n        const content:DocumentFragment = (this.element as HTMLTemplateElement).content;\n        if (content) {\n            const clone = content.cloneNode(true);\n            return new MiniJquery(clone as HTMLElement);\n        }\n        return null;\n    }\n}\n    // Object.defineProperty(window, \"$\", {\n    //     value: $,\n    //     writable: false,\n    //     enumerable: false,\n    //     configurable: false\n    // });\n\nconst $:any = (query:string | HTMLElement):MiniJquery=> {return new MiniJquery(query)};\nenum METHOD {\n    GET = \"GET\",\n    POST = \"POST\",\n    DELETE = \"DELETE\",\n    PUT = \"PUT\",\n};\ninterface paramObject {\n    [key:string]: any\n};\n[METHOD.GET, METHOD.POST, METHOD.DELETE, METHOD.PUT].forEach((method) => {\n    const param:paramObject = {\n        method: method,\n    };\n    $[method.toLowerCase()] = (url:string, content?: object):Promise<Response> => {\n        if (content) {\n            param.headers = { 'Content-Type': 'application/json' };\n            param.body = JSON.stringify(content);\n        }\n        return fetch(url, param);\n    };\n});\nexport default $; ","enum STATUS_CODES {\n    \"SUCCESS\" = 200,\n    \"BAD_RQUEST\" = 400,\n    \"UNAUTHORIZED\" = 401,\n    \"NOT_FOUND\" = 404,\n    \"DUPLICATED\" = 409,\n    \"INTERNAL_SERVER_ERROR\" = 500\n};\nenum ERROR_CODES {\n    \"WRONG_USER_ID\" = 3,\n    \"WRONG_USER_NAME\" = 4,\n    \"SESSION_NOT_FOUND\" = 5,\n    \"WRONG_SESSION\" = 6,\n    \"ITEM_ID_ERROR\" = 10,\n    \"ITEM_NAME_ERROR\" = 11,\n    \"ITEM_QUANTITY_ERROR\" = 12,\n    \"ITEM_DULPLICATED\" = 15,\n    \"NOT_FOUND\" = 1000 \n};\ninterface ERROR_OBJECT {\n    errorCode: ERROR_CODES\n    errorMessage?: string\n};\n\nexport {STATUS_CODES, ERROR_CODES, ERROR_OBJECT}","import $, { MiniJquery } from \"../utils/mini-jquery\";\nimport { dataObject , messageBody, messageObject, userObject} from \"../model/dataInterface\";\nimport {signOut} from \"../model/login\";\nimport {sendMessage, getMessage, receiveMessage, stopMessage} from \"../model/chat\";\nimport {receiveUsers, stopUser} from \"../model/users\"\nimport { STATUS_CODES, ERROR_CODES, ERROR_OBJECT } from \"../utils/status-error-codes\";\nimport {displayError, hideError} from \"./error\";\n\nconst chatPageTemplate:MiniJquery = $(\"#chat\");\nconst userTemplate:MiniJquery = $(\"#user\");\nconst chatTemplate:MiniJquery = $(\"#message\");\nlet resolver:any;\nconst displayChat = (parent:MiniJquery, data:Array<messageBody>) => {\n    const updateChat = ({userName, message, timestamp}:messageBody) => {\n        const messagePage:MiniJquery = chatTemplate.templateClone || $();\n        const name:MiniJquery = messagePage.find(\".chat-name\") || $();\n        const time:MiniJquery = messagePage.find(\".chat-time\") || $();\n        const content:MiniJquery = messagePage.find(\".chat-content\") || $();\n        time.time = timestamp;\n        name.updateContent(userName);\n        content.updateContent(message);\n        parent.append(messagePage);\n    };\n    const handlePromise = (timestamp:number) => {\n        receiveMessage(timestamp).then((content:messageObject)=>{\n            content.message.forEach((message:messageBody)=> {\n                updateChat(message);\n            });\n            parent.scrollToButtom();\n            handlePromise(timestamp);\n        }).catch((e:Error)=>{\n            //error handler\n            // if (e) {\n            //     console.error(e);\n            // }\n            if (resolver) {\n                stopMessage();\n                stopUser();\n                resolver();\n                resolver = null;\n            }\n        });\n    };\n    parent.removeChildren();\n    if (data) {\n        data.forEach((value:messageBody)=>{\n            updateChat(value);\n        });\n        parent.scrollToButtom();\n        let timestamp:number = 0;\n        if (data.length > 0) {\n            timestamp = data[data.length - 1].timestamp;\n        }\n        handlePromise(timestamp);\n    }\n};\nconst displayUser = (parent:MiniJquery) => {\n    const updateUser = (userName:string, userParent:MiniJquery) => {\n        const userPage:MiniJquery = userTemplate.templateClone || $();\n        const name:MiniJquery = userPage.find(\".user-name\") || $();\n        name.updateContent(userName);\n        userParent.append(userPage);\n    };\n    const handlePromise = (timestamp:number) => {\n        receiveUsers(timestamp).then((content:userObject)=>{\n            const parentNode:MiniJquery = $(\"\");\n            content.users.forEach((userName:string)=> {\n                updateUser(userName, parentNode);\n            });\n            parent.removeChildren();\n            parent.append(parentNode);\n            parent.scrollToButtom();\n            handlePromise(timestamp);\n        }).catch((e:Error)=>{\n            //error handler\n            if (e) {\n                console.error(e);\n            }\n            if (resolver) {\n                stopUser();\n                stopMessage();\n                resolver();\n                resolver = null;\n            }\n        });\n    };\n    const timestamp = 0;\n    handlePromise(timestamp);\n};\n\nconst displayChatPage = (stage: MiniJquery, chat: Array<messageBody>) => {\n    const chatPage:MiniJquery = chatPageTemplate.templateClone || $();\n    const messagePage: MiniJquery = chatPage.find(\".chat-detail\") || $();\n    const userPage: MiniJquery = chatPage.find(\".users-detail\") || $();\n    const signout:MiniJquery = chatPage.find(\".signout\") || $();\n    const send:MiniJquery = chatPage.find(\".send\") || $();\n    const message:MiniJquery = chatPage.find(\".message\") || $();\n    send.disable = true;\n    signout.onClick((event:Event) => {\n        event.preventDefault();\n        signOut().then(() => {\n            if (resolver) {\n                resolver();\n                resolver = null;\n            }\n            stopUser();\n            stopMessage();\n        });\n    });\n    message.onInput((event) => {\n        send.disable = message.value === \"\";\n    });\n    send.onClick(async (event) => {\n        const value = message.value;\n        const response:Response = await sendMessage(value);\n        if (response.ok) {\n            hideError();\n            message.value = \"\";\n            send.disable = true;\n        } else {\n            if (response.status === STATUS_CODES.UNAUTHORIZED) {\n                if (resolver) {\n                    stopMessage();\n                    stopUser();\n                    resolver();\n                    resolver = null;\n                }\n            } \n        }\n    });\n    stage.append(chatPage);\n    displayChat(messagePage, chat);\n    displayUser(userPage);\n    return new Promise((resolve, reject)=>{\n        resolver = resolve;\n    });\n};\n\nexport default displayChatPage;","import $, {MiniJquery} from \"../utils/mini-jquery\";\n\nconst CLASS_DISPLAY = \"display\";\nconst errorview:MiniJquery = $(\".error\");\n\nconst displayError = (message:string) => {\n    errorview.text = message;\n    errorview.addClass(CLASS_DISPLAY);\n};\nconst hideError = () => {\n    errorview.text = \"\";\n    errorview.removeClass(CLASS_DISPLAY);\n};\n\nexport {displayError, hideError};\n","import {getMessage}  from \"../model/chat\";\nimport $, { MiniJquery } from \"../utils/mini-jquery\";\nimport displayLoginPage from \"./login\";\nimport displayChatPage from \"./chat\";\nimport {displayError, hideError} from \"./error\";\nimport { STATUS_CODES, ERROR_CODES, ERROR_OBJECT } from \"../utils/status-error-codes\";\nimport { dataObject , messageBody} from \"../model/dataInterface\";\nenum PAGES {\n    LOGIN,\n    CHAT\n};\nconst WRONT_USER_ID_MESSAGE:string = \"Wrong user! Please login again.\";\nconst stage:MiniJquery = $(\"#stage\");\nconst loading:MiniJquery = $(\".loading\");\n\nlet currentPage:PAGES|null;\n\nconst displayPage = (page:PAGES, chat:Array<messageBody> = []) => {\n    switch(page) {\n        case PAGES.CHAT:\n            if (currentPage !== PAGES.CHAT) {\n                currentPage = PAGES.CHAT;\n                stage.removeChildren();\n                displayChatPage(stage, chat).then(() => {\n                    displayPage(PAGES.LOGIN);\n                });\n            }\n            break;\n        case PAGES.LOGIN:\n            if (currentPage !== PAGES.LOGIN) {\n                currentPage = PAGES.LOGIN;\n                stage.removeChildren();\n                displayLoginPage(stage).then(() => {\n                    renderPage();\n                });\n            }\n            break;\n        default:\n            break;\n    }\n};\n\nconst renderPage = async () => {\n    try {\n        loading.hidden = false;\n        const response:Response = await getMessage();\n        loading.hidden = true;\n        if (response.ok) {\n            hideError();\n            const chat = await response.json();\n            displayPage(PAGES.CHAT, chat);\n        } else if (response.status === STATUS_CODES.UNAUTHORIZED){\n            const errorMessage:ERROR_OBJECT = await response.json();\n            if (errorMessage.errorCode === ERROR_CODES.WRONG_USER_ID) {\n                displayError(WRONT_USER_ID_MESSAGE);\n            } else {\n                hideError();\n            }\n            displayPage(PAGES.LOGIN);\n        } else {\n            console.error(\"Unexpect error!\");\n        }\n    } catch(e) {\n        console.error(\"Unexpect error!\");\n    }\n};\n\nconst init = async () => {\n    return await renderPage();\n};\nexport default init;","import {signIn} from \"../model/login\";\nimport { STATUS_CODES, ERROR_CODES, ERROR_OBJECT } from \"../utils/status-error-codes\";\nimport $, {MiniJquery} from \"../utils/mini-jquery\";\nimport {displayError, hideError} from \"./error\";\n\nconst USER_NAME_ERROR_MESSAGE = \"User name is not valid!\";\nconst UNEXPECTED_ERROR_MESSAGE = \"Something went wrong!\";\nconst template:MiniJquery = $(\"#login\");\n\nconst displayLoginPage = (parentElement:MiniJquery):Promise<boolean> => {\n    const loginPage:MiniJquery = template.templateClone || $();\n    const input:MiniJquery = loginPage.find(\"#user-name\") || $();\n    const signin:MiniJquery = loginPage.find(\".signin\") || $();\n    \n    let resolver:any; \n    let rejecter:any; \n    \n    if (!loginPage.element) {\n        throw new Error(\"#signin is not a template node\");\n    } \n    signin.onClick(async (event) => {\n        event.preventDefault();\n        const response = await signIn(input.value||\"\");\n        input.clearValue();\n        if (response.ok) {\n            hideError();\n            resolver && resolver(true);\n        } else {\n            if (response.status === STATUS_CODES.UNAUTHORIZED) {\n                const error:ERROR_OBJECT = await response.json();\n                if (error.errorCode === ERROR_CODES.WRONG_USER_NAME) {\n                    displayError(USER_NAME_ERROR_MESSAGE);\n                    return;\n                }\n            }\n            displayError(UNEXPECTED_ERROR_MESSAGE);\n        }\n    });\n\n    parentElement.append(loginPage);\n    return new Promise((resolve, reject) => {\n        resolver = resolve;\n        rejecter = reject;\n    });\n};\n\nexport default displayLoginPage;"],"sourceRoot":""}