(this["webpackJsonpreact-todo"]=this["webpackJsonpreact-todo"]||[]).push([[0],{13:function(e,t,a){},14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(6),s=a.n(r),o=(a(13),a(1)),u=(a(14),a(7)),l={REFRESH:"refresh",DISPLAY_ERROR:"displayError",HIDE_ERROR:"hideError",SET_THEME:"setTheme"},i={};Object.values(l).forEach((function(e){i[e]=[]}));var m=function(e,t){var a=i[e];if(a){var n,c=Object(u.a)(a);try{for(c.s();!(n=c.n()).done;){(0,n.value)(t)}}catch(r){c.e(r)}finally{c.f()}}},E=function(e,t){var a=i[e];a&&a.indexOf(t)<0&&a.push(t)},f=function(e,t){var a=i[e];if(a){var n=a.indexOf(t);n>-1&&a.splice(n,1)}},d=400,R=401,h=403,b=404,O=503,v={},k={GET:"get",PUT:"put",DELETE:"delete",POST:"post"};Object.values(k).forEach((function(e){var t={method:e};v[e.toLowerCase()]=function(a,n){if(n)if(e!==k.GET)t.headers={"Content-Type":"application/json"},t.body=JSON.stringify(n);else{var c=Object.entries(n).map((function(e){var t=Object(o.a)(e,2),a=t[0],n=t[1];return"".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(n))})).join("&");a+=""===c?"":"?"+c}return fetch(a,t).catch((function(){return Promise.reject({ok:!1,status:O})})).then((function(e){return e.ok?e.json():Promise.reject(e)}))}}));var p=v,j=0,g=1,S=2,I=3,C=4,_=5,D=Object(n.memo)((function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e=function(e){console.log("here?"),r(function(e){var t="";switch(e){case j:t="User name is not valid!";break;case g:t="Unable to connect to server! Please try again!";break;case S:t="Wrong recipe id!";break;case I:t="Invalid user! Please login again!";break;case C:t="Param error!";break;case _:default:t="Something went wrong!"}return t}(e))},t=function(){console.log("hide?"),r("")};return E(l.DISPLAY_ERROR,e),E(l.HIDE_ERROR,t),function(){f(l.DISPLAY_ERROR,e),f(l.HIDE_ERROR,t)}}),[]),c.a.createElement("div",{className:"error ".concat(""===a?"":"display")},a)})),y=Object(n.memo)((function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(n.useCallback)((function(e){var t=e.target.value;r(t)}),[r]),u=Object(n.useCallback)((function(e){e.preventDefault(),p.post("/session",{username:a}).then((function(){r(""),m(l.REFRESH)})).catch((function(e){r(""),e.status===R||e.status===h?m(l.DISPLAY_ERROR,I):e.status===O&&m(l.DISPLAY_ERROR,g)}))}),[a,r]);return c.a.createElement("div",{className:"login-page"},c.a.createElement("label",null,"User Name:",c.a.createElement("input",{id:"user-name",type:"text",value:a,onChange:s,minLength:1})),c.a.createElement("button",{className:"signin",onClick:u},"submit"))})),P=a(2),L=a(3),A=Object(n.createContext)({theme:"dark"}),H=A,Y=Object(n.memo)((function(e){var t=e.username,a=Object(n.useContext)(H),r=Object(n.useState)(a.theme),s=Object(o.a)(r,2),u=s[0],i=s[1];Object(n.useEffect)((function(){i(a.theme)}),[a]);var E=Object(n.useCallback)((function(e){p.put("/theme/"+t,{theme:e}).then((function(){i(e),m(l.SET_THEME,e)})).catch((function(e){e.status===d?m(l.DISPLAY_ERROR,g):e.status!==h&&e.status!==R||(m(l.DISPLAY_ERROR,I),m(l.REFRESH))}))}),[t,i]),f=Object(n.useCallback)((function(){p.delete("session").finally((function(){m(l.REFRESH)}))}),[]);return c.a.createElement("div",{className:"user-action"},c.a.createElement("span",null,"Theme:"),c.a.createElement("input",{type:"radio",name:"theme",value:"dark",id:"default",onChange:function(){E("dark")},checked:"dark"===u}),c.a.createElement("label",{htmlFor:"default"},"dark"),c.a.createElement("input",{type:"radio",name:"theme",value:"light",id:"light",onChange:function(){E("light")},checked:"light"===u}),c.a.createElement("label",{htmlFor:"light"},"light"),c.a.createElement("button",{onClick:f,className:"logout"},"Logout"))})),T=Object(n.memo)((function(e){var t=e.refreshItems,a=e.addItem,r=Object(n.useState)(""),s=Object(o.a)(r,2),u=s[0],l=s[1],i=Object(n.useCallback)((function(e){var t=e.target.value;l(t)}),[]),m=Object(n.useCallback)((function(){a(u).finally((function(){l("")}))}),[a,u]);return c.a.createElement("div",{className:"new-item"},c.a.createElement("span",null,"New item:"),c.a.createElement("input",{type:"text",minLength:1,value:u,onChange:i}),c.a.createElement("button",{onClick:m},"Add"),c.a.createElement("button",{onClick:t,className:"refresh"},"Refresh"))})),N=Object(n.memo)((function(e){var t=e.username,a=Object(n.useMemo)((function(){return"/tasks/"+t}),[t]),r=Object(n.useState)(!0),s=Object(o.a)(r,2),u=s[0],i=s[1],E=Object(n.useState)("none"),f=Object(o.a)(E,2),v=f[0],k=f[1],j=Object(n.useCallback)((function(e,t){var a=t.items,n={};switch(t.type){case"add":case"update":n=Object(L.a)({},e,{},a);break;case"refresh":n=a;break;case"remove":var c=t.id;delete(n=Object(L.a)({},e))[c];break;default:throw new Error}return n}),[]),S=Object(n.useReducer)(j,{}),_=Object(o.a)(S,2),D=_[0],y=_[1],A=Object(n.useCallback)((function(e){var t={content:e,done:!1,timestamp:Date.now()};return p.post(a,{task:t}).then((function(e){var t=e.data.taskId;return p.get(a+"/"+t)})).then((function(e){var t=e.data,a=t.taskId,n=Object(P.a)({},a,t);m(l.HIDE_ERROR),y({type:"add",items:n})})).catch((function(e){e.status===R||e.status===h?(m(l.DISPLAY_ERROR,I),m(l.REFRESH)):e.status===O?m(l.DISPLAY_ERROR,g):e.status!==d&&e.status!==b||m(l.DISPLAY_ERROR,C)}))}),[a]),H=Object(n.useCallback)((function(){p.get(a).then((function(e){var t=e.data;m(l.HIDE_ERROR),y({type:"refresh",items:t})})).catch((function(e){e.status===R||e.status===h?(m(l.DISPLAY_ERROR,I),m(l.REFRESH)):e.status===O?m(l.DISPLAY_ERROR,g):e.status!==d&&e.status!==b||m(l.DISPLAY_ERROR,C)}))}),[a]),N=Object(n.useCallback)((function(e,t){var n=a+"/"+t.taskId,c=Object(L.a)({},t,{done:e});p.put(n,{task:c}).then((function(){m(l.HIDE_ERROR),y({type:"update",items:Object(P.a)({},t.taskId,c)})})).catch((function(e){e.status===R||e.status===h?(m(l.DISPLAY_ERROR,I),m(l.REFRESH)):e.status===O?m(l.DISPLAY_ERROR,g):e.status!==d&&e.status!==b||m(l.DISPLAY_ERROR,C)}))}),[a]),w=Object(n.useCallback)((function(e){var t=a+"/"+e;p.delete(t).then((function(){y({type:"remove",id:e})})).catch((function(e){e.status===R||e.status===h?(m(l.DISPLAY_ERROR,I),m(l.REFRESH)):e.status===O?m(l.DISPLAY_ERROR,g):e.status!==d&&e.status!==b||m(l.DISPLAY_ERROR,C)}))}),[a]),F=Object(n.useCallback)((function(e,t){var n=a+"/"+t.taskId,c=Object(L.a)({},t,{content:e});p.put(n,{task:c}).then((function(){m(l.HIDE_ERROR),y({type:"update",items:Object(P.a)({},t.taskId,c)})})).catch((function(e){e.status===R||e.status===h?(m(l.DISPLAY_ERROR,I),m(l.REFRESH)):e.status===O?m(l.DISPLAY_ERROR,g):e.status!==d&&e.status!==b||m(l.DISPLAY_ERROR,C)}))})),x=Object(n.useCallback)((function(e,t){e.target.checked&&k(t)}),[]);Object(n.useEffect)((function(){H()}),[H]);var M=Object(n.useCallback)((function(){var e=Object.values(D);switch(u||(e=e.filter((function(e){return!e.done}))),v){case"asc":e.sort((function(e,t){return e.content.localeCompare(t.content)}));break;case"des":e.sort((function(e,t){return t.content.localeCompare(e.content)}));break;default:e.sort((function(e,t){return t.timestamp-e.timestamp}))}return e.map((function(e){return c.a.createElement("div",{key:e.taskId,className:"item"},c.a.createElement("input",{type:"checkbox",checked:e.done,onChange:function(t){N(t.target.checked,e)}}),c.a.createElement("input",{type:"text",onChange:function(t){F(t.target.value,e)},value:e.content,className:e.done?"done":""}),c.a.createElement("button",{onClick:function(){w(e.taskId)},className:"delete"},"delete"))}))}),[D,N,u,v]);return c.a.createElement("div",null,c.a.createElement("div",{className:"options"},c.a.createElement("div",{className:"filters"},c.a.createElement("label",{htmlFor:"filter"},"Hide done tasks:"),c.a.createElement("input",{name:"filter",type:"checkbox",checked:!u,onChange:function(e){return i(!e.target.checked)}})),c.a.createElement("div",{className:"orders"},c.a.createElement("span",null,"Order:"),c.a.createElement("input",{type:"radio",name:"order",value:"none",checked:"none"===v,onChange:function(e){x(e,"none")}}),c.a.createElement("label",{htmlFor:"none"},"Latest"),c.a.createElement("input",{type:"radio",name:"order",value:"asc",checked:"asc"===v,onChange:function(e){x(e,"asc")}}),c.a.createElement("label",{htmlFor:"asc"},"A-Z"),c.a.createElement("input",{type:"radio",name:"order",value:"dec",checked:"des"===v,onChange:function(e){x(e,"des")}}),c.a.createElement("label",{htmlFor:"dec"},"Z-A"))),c.a.createElement("div",{className:"items"},M()),c.a.createElement(T,{refreshItems:H,addItem:A}),c.a.createElement(Y,{username:t}))})),w=Object(n.memo)((function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(n.useCallback)((function(){p.get("/session").then((function(e){var t=e.data,a=t.username,n=t.theme;r(a),m(l.HIDE_ERROR),m(l.SET_THEME,n)})).catch((function(e){r(""),e.status!==R&&m(l.DISPLAY_ERROR,g),m(l.SET_THEME,"dark")}))}),[r]);return Object(n.useEffect)((function(){return s(),E(l.REFRESH,s),function(){f(l.REFRESH,s)}}),[s]),c.a.createElement("div",{id:"stage"},c.a.createElement(D,null),""===a?c.a.createElement(y,null):c.a.createElement(N,{username:a}))}));var F=function(){var e=Object(n.useState)("dark"),t=Object(o.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e=function(e){"light"!==e&&(e="dark"),r(e)};return E(l.SET_THEME,e),function(){f(l.SET_THEME,e)}}),[r]),c.a.createElement(H.Provider,{value:{theme:a}},c.a.createElement("div",{className:"".concat(a+"-theme"," App")},c.a.createElement("header",null,c.a.createElement("h2",null,"TODO APP")),c.a.createElement("main",null,c.a.createElement(w,null)),c.a.createElement("footer",null,c.a.createElement("ul",{className:"footer-personal-info"},c.a.createElement("li",null,"\xa9 2020 Yiji Huang"),c.a.createElement("li",{className:"footer-divider"}),c.a.createElement("li",null,c.a.createElement("span",null,"E-mail: "),c.a.createElement("a",{href:"mailto:huang.yiji@husky.neu.edu"},"huang.yiji@husky.neu.edu"))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.afcb2b9b.chunk.js.map